# Markdown转图片工具需求文档

## 项目概述

### 项目名称
**md2pic** - Markdown转图片工具

### 项目定位
一个现代化的Web应用程序，专门用于将Markdown文档转换为精美的可视化图片，特别适用于社交媒体内容创作（如小红书、微博、朋友圈等）。

### 核心价值
- **内容创作效率提升**：快速将文档内容转换为社交媒体友好的图片格式
- **可视化编辑体验**：所见即所得的拖拽式编辑界面
- **多平台适配**：支持各种社交媒体平台的图片尺寸规格
- **专业视觉效果**：提供多种主题和样式选择


## 功能需求规格

### 1. Markdown编辑器模块

#### 1.1 基础编辑功能
- **实时编辑**：支持Markdown语法的实时输入和编辑
- **语法高亮**：提供Markdown语法的可视化高亮显示
- **自动保存**：编辑内容的本地缓存和恢复
- **字体设置**：使用等宽字体（JetBrains Mono/Consolas/Monaco）

#### 1.2 文件操作功能
- **文件导入**：
  - 支持.md和.markdown格式文件
  - 拖拽导入功能
  - 文件选择器导入
  - 导入进度提示和错误处理
- **文件导出**：支持将编辑内容导出为.md文件

#### 1.3 编辑体验优化
- **拖拽区域**：可视化的文件拖拽提示
- **占位符文本**：友好的输入提示
- **响应式布局**：自适应编辑器宽度调整

### 2. 可视化编辑器模块

#### 2.1 画布渲染功能
- **Markdown解析**：将Markdown内容解析为可视化元素
- **实时预览**：编辑内容的即时可视化反馈
- **元素类型支持**：
  - 标题（H1, H2, H3）
  - 段落文本
  - 粗体文本
  - 列表（有序、无序）
  - 引用块
  - 代码块
  - 表格

#### 2.2 拖拽编辑功能
- **元素选择**：点击选中任意可视化元素
- **拖拽移动**：鼠标拖拽调整元素位置
- **尺寸调整**：8个方向的缩放手柄
- **对齐辅助**：拖拽时的智能对齐线
- **多选操作**：支持多个元素的批量操作

#### 2.3 元素操作功能
- **就地编辑**：双击元素进入编辑模式
- **快捷操作**：
  - 字体大小调节（±按钮）
  - 元素类型显示
  - 删除操作
  - 复制/粘贴功能
- **键盘快捷键**：
  - Delete键删除元素
  - Ctrl+Z/Ctrl+Y 撤销重做
  - Enter保存编辑
  - Escape取消编辑

#### 2.4 撤销重做系统
- **历史记录**：保存最近50个操作状态
- **智能保存**：在关键操作节点自动保存历史
- **状态恢复**：支持撤销和重做操作
- **键盘快捷键**：标准的Ctrl+Z/Ctrl+Y快捷键

### 3. 表格处理模块

#### 3.1 表格渲染功能
- **Markdown表格解析**：自动识别和解析Markdown表格语法
- **智能列宽**：根据内容长度智能分配列宽
- **对齐支持**：左对齐、居中、右对齐
- **样式优化**：
  - 交替行背景色
  - 边框和阴影效果
  - 自适应字体大小
  - 内容溢出处理

#### 3.2 表格编辑功能
- **单元格编辑**：支持表格内容的直接编辑
- **结构调整**：动态调整表格行列数量
- **样式设置**：自定义表格样式和颜色

#### 3.3 表格导出优化
- **高度计算**：确保表格完整显示不被截断
- **内容适配**：自动调整单元格高度适应内容
- **导出质量**：保证截图时表格的完整性

### 4. 样式控制模块

#### 4.1 全局样式设置
- **配色主题**：
  - 粉色系、蓝色系、绿色系
  - 紫色系、橙色系
  - 自定义主题色
- **字体大小**：
  - 自动适配模式
  - 手动尺寸调节
  - 响应式字体缩放
- **文字对齐**：左对齐、居中、右对齐
- **行高设置**：紧密、正常、宽松三种模式

#### 4.2 标题样式配置
- **分级颜色设置**：
  - H1标题颜色（默认蓝色 #2563eb）
  - H2标题颜色（默认绿色 #059669）
  - H3标题颜色（默认橙色 #ea580c）
  - 粗体文字颜色（默认紫色 #7c3aed）
- **实时预览**：样式设置的即时可视化反馈

#### 4.3 元素级样式编辑
- **颜色设置**：
  - 文字颜色选择器
  - 背景颜色设置
  - 快速颜色预设
  - 十六进制色值输入
- **字体调节**：
  - 滑动条调节字体大小（0.5x-3x）
  - 实时百分比显示
  - 快捷按钮微调
- **对齐控制**：元素级别的文字对齐设置

### 5. 画布格式模块

#### 5.1 预设格式支持
- **小红书格式**：1080×1440像素
- **微博格式**：1080×1080像素
- **微信朋友圈**：1080×1260像素
- **Instagram格式**：1080×1080像素
- **Twitter格式**：1200×675像素
- **自定义尺寸**：用户自定义宽高

#### 5.2 缩放和预览
- **缩放功能**：10%-200%的画布缩放
- **实时调整**：拖拽调节画布尺寸
- **预览模式**：全屏预览效果

### 6. 多页面分割模块

#### 6.1 智能分割功能
- **按标题分割**：根据H1/H2标题自动分页
- **分割级别选择**：用户可选择分割的标题级别
- **内容保持**：确保相关内容在同一页面

#### 6.2 页面管理功能
- **页面导航**：底部页面切换器
- **页面状态**：显示当前页码和总页数
- **快速跳转**：点击页码快速切换页面

### 7. 导出功能模块

#### 7.1 单页导出
- **高质量截图**：使用html2canvas生成高清图片
- **格式支持**：PNG格式导出
- **文件命名**：自动生成带时间戳的文件名
- **下载提示**：成功/失败状态反馈

#### 7.2 批量导出
- **全页面导出**：一键导出所有页面为ZIP文件
- **进度提示**：批量导出的进度显示
- **错误处理**：网络异常和导出失败的处理
- **文件组织**：ZIP文件内的合理文件命名

#### 7.3 导出优化
- **截图优化**：
  - 2倍分辨率提升图片质量
  - 白色背景确保显示效果
  - 表格渲染优化
  - 内容完整性检查
- **性能优化**：
  - 异步处理避免界面卡顿
  - 内存管理防止浏览器崩溃
  - 大文件处理优化

### 8. 用户界面模块

#### 8.1 布局系统
- **三栏布局**：编辑器、画布、控制面板
- **可调节布局**：拖拽分割线调整区域大小
- **响应式设计**：适配不同屏幕尺寸
- **最小宽度限制**：保证各区域可用性

#### 8.2 交互反馈
- **状态提示**：使用sonner库提供友好的消息提示
- **加载状态**：操作过程中的Loading指示
- **错误处理**：用户友好的错误信息提示
- **操作确认**：重要操作的二次确认

#### 8.3 主题系统
- **浅色主题**：默认的浅色界面主题
- **渐变效果**：标题栏和控制面板的渐变背景
- **颜色系统**：统一的颜色规范和变量

### 9. 性能需求

#### 9.1 渲染性能
- **虚拟化渲染**：大量元素时的性能优化
- **防抖处理**：频繁操作的防抖机制
- **内存管理**：及时清理不需要的资源

#### 9.2 交互性能
- **实时响应**：编辑操作的即时反馈（<100ms）
- **流畅动画**：CSS过渡动画的流畅性
- **大文件处理**：优化大型Markdown文件的处理

## 用户体验需求

### 1. 易用性要求
- **学习成本低**：直观的拖拽操作界面
- **操作连贯性**：流畅的工作流程设计
- **错误容错性**：用户误操作的恢复机制

### 2. 可访问性要求
- **键盘导航**：完整的键盘操作支持
- **屏幕阅读器**：基本的无障碍访问支持
- **颜色对比度**：符合WCAG标准的颜色对比

### 3. 兼容性要求
- **浏览器支持**：Chrome/Firefox/Safari/Edge现代版本
- **操作系统**：Windows/macOS/Linux跨平台支持
- **设备支持**：桌面端优先，平板端基本支持

## 扩展功能需求

### 1. 高级编辑功能
- **模板系统**：预设的内容模板
- **元素库**：可重用的设计元素
- **批量操作**：多元素的批量样式调整

### 2. 协作功能
- **云端保存**：内容的云端存储和同步
- **分享功能**：生成分享链接的功能
- **版本管理**：文档版本历史记录

### 3. 高级导出
- **多格式支持**：PDF、SVG等格式导出
- **水印功能**：自定义水印添加
- **批量处理**：批量文件的自动化处理

## 技术实现要点

### 1. 架构设计
- **组件化开发**：高度模块化的组件设计
- **状态管理**：合理的全局状态管理策略
- **类型安全**：完整的TypeScript类型定义

### 2. 性能优化
- **代码分割**：按需加载减少初始包大小
- **资源优化**：图片和静态资源的优化
- **缓存策略**：合理的浏览器缓存策略

### 3. 开发体验
- **热更新**：开发时的快速更新反馈
- **类型检查**：严格的TypeScript类型检查
- **代码规范**：ESLint规则和代码格式化

## 测试需求

### 1. 单元测试
- **组件测试**：关键组件的单元测试
- **工具函数测试**：核心逻辑的单元测试
- **类型测试**：TypeScript类型的正确性验证

### 2. 集成测试
- **用户流程测试**：完整操作流程的自动化测试
- **兼容性测试**：多浏览器环境的兼容性验证
- **性能测试**：关键操作的性能基准测试

### 3. 用户测试
- **可用性测试**：真实用户的使用体验测试
- **A/B测试**：界面和交互方案的对比测试
- **压力测试**：大量数据和高频操作的压力测试

## 部署和维护需求

### 1. 构建部署
- **静态部署**：支持静态文件服务器部署
- **CDN优化**：静态资源的CDN加速
- **环境配置**：开发/测试/生产环境的配置管理

### 2. 监控和维护
- **错误监控**：前端错误的收集和分析
- **性能监控**：页面性能指标的监控
- **用户行为分析**：使用模式的数据分析

### 3. 持续优化
- **用户反馈**：用户建议的收集和处理机制
- **功能迭代**：基于使用数据的功能优化
- **技术升级**：依赖库和框架的持续升级

---

**文档版本**：v1.0  
**创建日期**：2024年12月  
**维护团队**：开发团队  
**审核状态**：待审核 